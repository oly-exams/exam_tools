build:pre_commit:
    extends: .build:build_cached_push
    variables:
        SERVICE_NAME: pre_commit
        OVERWRITE_COMPOSE: docker/overwrite/pre_commit_diff.yml
    rules:
        - if: '$DOCKER_CACHE == "0"'
        - if: '$IMG_NAME != $IMG_COMPARE'
        - changes:
            - docker/pre_commit/*
            - .pre-commit-config.yaml
            - requirements.txt
            - requirements_dev.txt

test:pre_commit:
    extends: .test:pull_and_run
    variables:
        ALL_SERVICE_NAME: pre_commit

merge:pre_commit:
    extends: .test:pull_and_run
    rules:
        - if: '$CI_PIPELINE_SOURCE == "web"'
        - if: '$CI_PIPELINE_SOURCE == "schedule"'
        - if: '$CI_PIPELINE_SOURCE == "merge_request_event"'
    variables:
        ALL_SERVICE_NAME: pre_commit
        OVERWRITE_COMPOSE: docker/overwrite/pre_commit_all.yml
