build:testing_cypress:
    extends: .build:build_cached_push
    variables:
        SERVICE_NAME: testing_cypress
        DEPENDENT_SERVICE: django_server
    rules:
        - if: '$DOCKER_CACHE == "0"'
        - if: '$IMG_NAME != $IMG_COMPARE'
        - changes:
            - docker/testing_cypress/*

test:testing_cypress:
    extends: .test:pull_and_run_2
    variables:
        SERVICE_NAME_1: testing_cypress
        SERVICE_NAME_2: django_server
        ENV_FILE: docker/env/testing_cypress.env
    after_script:
        # copying makes the folderstructure look nicer on gitlab
        - cp e2e/cypress/videos $CI_PROJECT_DIR/videos
        - cp e2e/cypress/screenshots $CI_PROJECT_DIR/screenshots
    artifacts:
        paths:
            - $CI_PROJECT_DIR/videos
            - $CI_PROJECT_DIR/screenshots
        reports:
            junit: e2e/cypress/reports/*.xml
