build:pre-commit:
    extends: .build:build_cached_push
    variables:
        SERVICE_NAME: pre-commit
    rules:
        - if: '$DOCKER_CACHE == "0"'
        - if: '$IMG_NAME != $IMG_COMPARE'
        - changes:
            - docker/pre-commit/*
            - .pre-commit-config.yaml

test:pre-commit:
    extends: .test:pull_and_run
    variables:
        SERVICE_NAME: pre-commit

merge:pre-commit:
    extends: .test:pull_and_run
    rules:
        - if: '$CI_PIPELINE_SOURCE == "web"'
        - if: '$CI_PIPELINE_SOURCE == "schedule"'
        - if: '$CI_PIPELINE_SOURCE == "merge_request_event"'
    variables:
        SERVICE_NAME: pre-commit
        CMD: pre-commit run --all-files
