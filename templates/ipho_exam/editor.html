{% extends "base.html" %}
{% load static %}

{% block extra-head %}
<style>
.title-dropdown {
    display: inline-block;
}
.title-dropdown .btn {
    padding: 0px 28px;
    padding: 0;
    font-size: 28px;
    line-height: normal;
    -webkit-border-radius: 8px;
       -moz-border-radius: 8px;
            border-radius: 8px;
}
.title-dropdown .dropdown-menu {
    font-size: 20px;
}
body { margin-bottom: 70px; }
</style>

{% endblock %}


{% block content %}
<div class="container">

{% if warning %}
    <div class="alert alert-warning alert-dismissible" role="alert">
      <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
      <strong>Warning:</strong> {{ warning }}
    </div>
{% endif %}

<div class="page-header">
    <div class="dropdown pull-right">
      <a class="btn btn-primary btn-lg dropdown-toggle" type="button" data-toggle="dropdown">
{% if exam %}
        {{ exam.name }}
{% else %}
        Select exam
{% endif %}
        <span class="caret"></span>
      </a>
      <ul class="dropdown-menu">
    {% for ex in exam_list %}
        <li {% if exam == ex %} class="active" {% endif %}><a href="{% url 'exam:editor-exam' exam_id=ex.pk %}">{{ ex.name }}</a></li>
    {% endfor %}
      </ul>
    </div>
  <h1>Exam editor</h1>
</div>

<!-- <div class="page-header">
  <h2>Exam editor :

  <span class="title-dropdown dropdown">
    <a class="btn btn-link btn-lg dropdown-toggle" type="button" data-toggle="dropdown">
      Theory Exam
      <span class="caret"></span>
    </a>
    <ul class="dropdown-menu">
      <li><a href="#">Demo Exam</a></li>
      <li class="active"><a href="#">Theory Exam</a></li>
      <li><a href="#">Experimental Exam</a></li>
    </ul>
  </span>
  </h2>
</div> -->

<ul class="nav nav-tabs">
    {% for q in exam.question_set.all %}
        <li {% if question == q %} class="active" {% endif %}><a href="{% url 'exam:editor-question' exam_id=exam.pk question_id=q.pk %}">{{ q.name }}</a></li>
    {% endfor %}
</ul>

{% if question %}
    
    <h3>{{ question.name }} <small><i class="fa fa-fw fa-lg fa-unlock"></i></small></h3>
    
    
    {% with content_set as fields_set %}
        {% include 'ipho_exam/editor_field.html' %}
    {% endwith %}
    
    
    <div class="navbar navbar-default navbar-fixed-bottom">
      <div class="container">
        <div class="navbar-right">
            <button type="button" class="btn btn-default navbar-btn"><i class="fa fa-fw fa-unlock"></i> Lock</button>
            <button type="button" class="btn btn-primary navbar-btn"><span class="glyphicon glyphicon-floppy-disk"></span> Save</button>
        </div>
    
      </div>
    </div>
{% endif %}
</div> <!-- /container -->

{% endblock %}



{% block extra-script %}
    <script src="{% static "ckeditor/ckeditor.js" %}"></script>
    <script src="{% static "mathquill/mathquill.min.js" %}"></script>
    
    <script>
        CKEDITOR.plugins.addExternal( 'mathedit', '{% static "mathedit/" %}', 'plugin.js' );
        
        $(function(){
            
            $(".translate-original").each(function() {
                var newtext = $(this).html().replace(/\$(.+?)\$/g, '<img src="http://latex.codecogs.com/svg.latex?$1" />');
                $(this).html(newtext);
            });
            $(".translate-foreign").each(function() {
                var newtext = $(this).html().replace(/\$(.+?)\$/g, '<img src="http://latex.codecogs.com/svg.latex?$1" />');
                $(this).html(newtext);
            });
            
            $(".translate-copy-button").click(function( event ) {
                event.preventDefault();
            });
            
            
            // var newtext = $("#editor1").html().replace(/\$(.+?)\$/g, '<img src="http://latex.codecogs.com/svg.latex?$1" />');
            // $("#editor1").html(newtext);
            
            // CKEDITOR.inline( 'exam-translation', {
            //     extraPlugins: 'mathedit',
            //     // height : '600px',
            // });
            
            CKEDITOR.config.toolbarGroups = [
						{ name: 'editing',		groups: [ 'basicstyles', 'links' ] },
						{ name: 'undo' },
                        '/',
						{ name: 'clipboard',	groups: [ 'selection', 'clipboard' ] },
                        { name: 'insert' },
						{ name: 'about' }
					];
            
        });
        
    </script>
    
{% endblock %}
